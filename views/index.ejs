<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Loctel | Cineto Telecomunicaciones</title>

    <link href="css/plugins/toastr/toastr.min.css" rel="stylesheet">
    <link href="css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/plugins/datapicker/datepicker3.css" rel="stylesheet">

</head>

<body class="">

    <div id="wrapper">

        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav metismenu" id="side-menu">
                    <li class="nav-header">
                        <div class="dropdown profile-element">
                            <span>
                                <img alt="image" class="img-rounded" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAH8AAABiCAYAAAB59QxWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABq1JREFUeNrsnb9vGzcUxynBawy5e+GruzcqmrXwFXDGOvLQjonawVm12VvUrZ4qj/FSCd3qofIcAzntNSLlDwjkZrdktbt6bN8hB0Xk8e7IR/L0vsCDYd8P8vjhj/dI3rm2XC4ZaTNV34BnDGPrxhbFNo5tucb4sSGcFxZMpx3bPLamLwVTq2jLD2LrxPZDbNsF73EFFWIIULPA/5r6nafbd76UOPwKWRBbf6lf/J6hIM225Bqny6tK4DuxLZZmFa1UgrbC+c6WWRW6/QZ0zfuIaV6Bn/BLxnlOd/++w29C4T50MG/Oj/tbnoMfKTp0k5S3P4Wf8zX3a4C33ypZobxw+Hxt+RzS29g+lZyzAA+8B8CLRgw/xvagauB9hd+AVixrmecQs881pBcAzP0qgfcVPi/cZ4Jj72M7hG5d9xDzpkrgfRzzWxLwExiv5wbAjyTH/4ntW+iNvJJP07u8ux9YAr8tAf91CnwfZvuo20fq7nlX/4VF8OOVuYZb8BOo5WtSKOnunzoAPko5hLu+tH5fWn4k8LYHBgq6CPjVyMOL1l/3pNWvA/83xOG2wDMIJ9eFnLvgnFLLL+DYhQAihBa0i9Dq84JP8noruGYCfsAUzL1owKFVJr5CNsyxwtbUmDa/170krXtJer2cq4J89bFBS7r/Wze2v3IurU4dAZ/sISi6RyCwWfZ1y2M57w5fMPkcvcgBxOjqF+BvyGYMp9DF5xWPXt6C37BRDh9/4NeCsRwLvg7wiYYF8/AAKn8E/kPl4ffhgcto6hB4HZVx30YF2LIA/pniuRP2Yf1dJ3zd4JP8HK1MNgVgolB1VQ+hAoQGJq2se/sdRUeubdAbLuvclY1mIkVHsFLefjPjge+hcEznwRb4tLUy8rGEcyqzgTOSdH0TmA2bGkzfRFdfRgE4iaINKSjTwxjwQ/Ds18nUipzL4FVmB7mMbw7B8PZlU7CHDoJvQk9luuXx534iOd4xTsbwuNKQjGs9B8f49DVYPoDsDaPA5xm+UHKs52CLT1+zDb+bfvFSVg4tn7t9UcFdGXbwhiXBM8QKMJZMDzd9hh8anpuXtZhFSfDpCtBGiIZEUYG38BuS2s4Mt6Z9iCbKgOcaIDhfkWTa19tQT3TzGmI4xQv2sxLg2wj5lIXDNYJfrgIEDoNP8jjDLqtN+CzL3HHwxsd21+CHltJVAT9i+FuvA0levIV/ayOEKQF+wuzsug0lvZa38MeOtHxV8CHDWkv/ODRFj4pMwxeFME8QxznXwfN0RdvZhj7Dl2W+TeD/U1fw94XvLX8qcVpeGG79PoDvMPFEzh+mE7e9nj8x5Pz5AL6VAfhL31t+Mu6LWj/fydLfQPB8yPstI9w0v7kEaQ9fmLFnbaxp7bqpsD9ubPF1qYbi613Nqr2u1c144AWc06go+Lbia2ndqn6BM2JqK1UjODdaiXeTb+U1Vzxl1W/ynae6+jFCt9+Asf2IqX0vcIQ5B4INX+UzaipKj9l5PsbostD9EOy5/Tk8YJk56/cE3k/46QrwU4Fr+cTHYcXAn8OzoEceNpd0+XjNN1kMcoBPNmRUATzP/zcMY4u2I2O+SAEUAneOdisOnm9e7TEHPtPi4jd5AvbhWzyJd9/xFPw95DsxlX/ZstHwfZ6580p1Ak/wCTzB9xL8gMAXk+ufXG8zt3bZVko+OHwRw/vuLnX7jqnFPn6RkcBvCPxkOnhC4M3Bf8nW/5PhpUMV4IjAC5Wbn0+va/EKMCTGm9Xt29axwz0iwScRfBLBJxF8Ejr8k9h+lzhIqsbvc4CY3t6aeyfHXkrSX3evY0N5fQX30Cadc/t/xvaVpnv9DD9PYztDSM+0dOT1AIxXrkdM/BkX9JZ/YgjEiST88gW87rLZk/QuVuCbArEj6P4PmD8yUTYHLsHfMVh4e4p/060a2HOFc9J2oZjX7wXXp+1xjjKxBl+UmQuFB+T2iabKdqmY3qq9M1iJRHmd2e6SXAn1Zo7dZyO0RUVgTa+o5ZMIPongb5IeF3ROuX1O8Ena4M8sxfE677+DXH47DrHMzU8V/h1bv/iSSBQny3bBpO1O04N+x4otmhwXLNQ7lr3DZ4ZUcXLzqyMkXFbvFP+Gmb6O68us8GlZ3UvDvy5xnxuDXdm6fF0jwr8pWblvkPJ5XQY+z+RlwYTPDD2kaDn3ArFQuZ6XfIYbpEp6WRQ+F19sOC1YCR6VuHZVpxAKnSGll6VLyM9pweux8pqLn08fZyAZDPVIBJ9E8EkEn0TwSQSfRPBJBJ9E8EkEn+Sb/hVgANl4nG+v2oCgAAAAAElFTkSuQmCC" />
                            </span>
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                                <span class="clear">
                                    <span class="block m-t-xs">
                                        <strong class="font-bold" style="text-transform: uppercase;">
                                            SUPER USUARIO
                                        </strong>
                                    </span>
                                    <span class="text-muted text-xs block">
                                        ADMINISTRADOR
                                        <b class="caret"></b>
                                    </span>
                                </span>
                            </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                <li>
                                    <a href="">Perfil</a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="/">Cerrar Sesión</a>
                                </li>
                            </ul>
                        </div>
                        <div class="logo-element">
                            LT+
                        </div>
                    </li>
                    <li class="active">
                        <a href="/">
                            <i class="fa fa-key"></i>
                            <span class="nav-label">Generación Códigos</span>
                        </a>
                    </li>
                    <li>
                        <a href="/codigos">
                            <i class="fa fa-key"></i>
                            <span class="nav-label">Lista Códigos</span>
                        </a>
                    </li>
                </ul>

            </div>
        </nav>

        <div id="page-wrapper" class="gray-bg">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top  " role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#">
                            <i class="fa fa-bars"></i>
                        </a>
                        <div role="search" class="navbar-form-custom">
                            <div class="form-group">
                                <input type="text" value="SUPER USUARIO" class="form-control" name="top-search" id="top-search" disabled>
                            </div>
                        </div>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <span class="m-r-sm text-muted welcome-message" style="text-transform: uppercase; font-weight: bold;">
                            SUPER USUARIO Bienvenido a Loctel</span>
                        </li>
                        <li>
                            <a href="">
                                <i class="fa fa-sign-out"></i> Cerrar Sesión</a>
                            </li>
                        </ul>

                    </nav>
                </div>

                <div class="row wrapper border-bottom white-bg page-heading">
                    <div class="col-sm-4">
                        <h2>Generación Códigos</h2>
                        <ol class="breadcrumb">
                            <li>
                                <a>Administrador</a>
                            </li>
                            <li class="active">
                                <strong>Códigos</strong>
                            </li>
                        </ol>
                    </div>
                </div>

                <div class="wrapper wrapper-content animated fadeInRight">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>Generación de Códigos de Venta</h5>
                                </div>
                                <div class="ibox-content">

                                    <div class="row">
                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="form-group">
                                                <label>Empresa Receptora:</label>
                                                <input type="text" class="form-control" id="DEPLOY" placeholder="Ingresar nombre de la empresa">
                                            </div>
                                        </div>

                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <div class="form-group" id="data_1">
                                                <label>Fecha Registro:</label>
                                                <div class="input-group date">
                                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span><input type="text"
                                                    class="form-control" id="DATE">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <div class="form-group" id="data_1">
                                                <label>Fecha Expiración:</label>
                                                <div class="input-group date">
                                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span><input type="text"
                                                    class="form-control" id="DATEEXP">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <div class="form-group">
                                                <label>Clave Secreta:</label>
                                                <input type="text" class="form-control" onkeypress="return soloLetras(event)" id="RECRET" placeholder="Ingresar una cadena de números y letras (Mayúsculas)">
                                            </div>
                                        </div>

                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <div class="form-group">
                                                <label>MAC:</label>
                                                <input type="text" class="form-control" id="MAC" placeholder="Ingresar dirección MAC">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
                                            <div class="form-group">
                                                <label>Código</label>
                                                <input type="text" class="form-control" id="COD1">
                                            </div>
                                        </div>

                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
                                            <div class="form-group">
                                                <label>&nbsp</label>
                                                <input type="text" class="form-control" id="COD2">
                                            </div>
                                        </div>

                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
                                            <div class="form-group">
                                                <label>&nbsp</label>
                                                <input type="text" class="form-control" id="COD3">
                                            </div>
                                        </div>

                                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6">
                                            <div class="form-group">
                                                <label>&nbsp</label>
                                                <input type="text" class="form-control" id="COD4">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                            <div class="form-group">
                                                <button class="btn btn-success" id="LOCGEN" style="width: 100%">
                                                    <i class="fa fa-spinner"></i> Generar Código</button>
                                                </div>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                                <div class="form-group">
                                                    <button class="btn btn-primary" id="SAVE" style="width: 100%">
                                                        <i class="fa fa-save"></i> Guardar Código</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Mainly scripts -->
                <script src="js/jquery-3.1.1.min.js"></script>
                <script src="js/bootstrap.min.js"></script>
                <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
                <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

                <!-- Custom and plugin javascript -->
                <script src="js/inspinia.js"></script>
                <script src="js/plugins/pace/pace.min.js"></script>
                <script src="js/plugins/sweetalert/sweetalert.min.js"></script>
                <script src="js/plugins/toastr/toastr.min.js"></script>
                <script src="js/plugins/datapicker/bootstrap-datepicker.js"></script>

                <script>
                    DireccionMac();
                    InsertarFecha();

                    $('#LOCGEN').click(function (event) {

                        if ($('#RECRET').val().length > 0 && $('#MAC').val().length > 0) {
                            var key = $('#RECRET').val();
                            var mac = $('#MAC').val();
                            $('#COD1').val(XAW13CSA9(4, key.replace(/ /g, "").toUpperCase() + mac.replace(/-/g, "").toUpperCase()));
                            $('#COD2').val(XAW13CSA9(4, key.replace(/ /g, "").toUpperCase() + mac.replace(/-/g, "").toUpperCase()));
                            $('#COD3').val(XAW13CSA9(4, key.replace(/ /g, "").toUpperCase() + mac.replace(/-/g, "").toUpperCase()));
                            $('#COD4').val(XAW13CSA9(4, key.replace(/ /g, "").toUpperCase() + mac.replace(/-/g, "").toUpperCase()));
                        } else {
                            swal("Advertencia", "Ingresar Clave Secreta y/o Ingresar MAC", "warning");
                        }
                    });

                    $('#SAVE').click(function (event) {

                        if (Validar()) {

                            var fecha = $('#DATE').val();
                            var empresa = $('#DEPLOY').val();
                            var serie = $('#RECRET').val();
                            var mac = $('#MAC').val();
                            var codigo = $('#COD1').val() + "-" + $('#COD2').val() + "-" + $('#COD3').val() + "-" + $('#COD4').val();
                            var fechaExp = $('#DATEEXP').val();

                            GuardarCodigo(fecha, empresa, serie, mac, codigo, fechaExp);
                        }

                    });

                    function GuardarCodigo(fecha, empresa, serie, mac, codigo, fechaExp){
                       $.ajax({
                        type: "POST",
                        url: "/GuardarCodigo",
                        data: {fecha: fecha, empresa: empresa, serie: serie, mac: mac, codigo: codigo, fechaExp:fechaExp},
                        success: function (res) {

                            toastr.success(res[0].msm, 'Gestión Generación Códigos');
                            LimpiarCampos();
                        }
                    });
                   }

                   function XAW13CSA9(CITEL, ENADA) {
                    COMCIN = parseInt(CITEL);
                    var ARCT = ENADA;
                    var TRASE = "";
                    for (i = 0; i < COMCIN; i++) TRASE += ARCT.charAt(Math.floor(Math.random() * ARCT.length));

                        return TRASE;
                }

                function DireccionMac() {

                    $.ajax({
                        type: "GET",
                        url: "/DireccionMac",
                        success: function (responseText) {
                            $('#MAC').val("");
                            $('#MAC').val(responseText);
                        }
                    });
                }

                function soloLetras(e) {
                    key = e.keyCode || e.which;
                    tecla = String.fromCharCode(key).toLowerCase();
                    letras = " áéíóúabcdefghijklmnñopqrstuvwxyz0123456789";
                    especiales = [];

                    tecla_especial = false
                    for (var i in especiales) {
                        if (key == especiales[i]) {
                            tecla_especial = true;
                            break;
                        }
                    }

                    if (letras.indexOf(tecla) == -1 && !tecla_especial)
                        return false;
                }

                function InsertarFecha() {
                    $('#data_1 .input-group.date').datepicker({
                        format: 'yyyy-mm-dd',
                        todayBtn: "linked",
                        keyboardNavigation: false,
                        forceParse: false,
                        calendarWeeks: true,
                        autoclose: true
                    }).datepicker("setDate", new Date());;
                }

                function d2(n) {
                    if (n < 9) return "0" + n;
                    return n;
                }

                function Validar() {

                    if ($('#DEPLOY').val().length > 0) {
                        if ($('#DATE').val().length > 0) {
                            if ($('#RECRET').val().length > 0) {
                                if ($('#MAC').val().length > 0) {
                                    if ($('#COD1').val().length > 0 && $('#COD2').val().length > 0 && $('#COD3').val().length > 0 && $('#COD4').val().length > 0) {
                                        if ($('#DATEEXP').val().length > 0) {
                                        return true;
                                    } else {
                                        swal("Advertencia", "Ingresar Fecha Expiración", "warning");
                                    }
                                } else {
                                    swal("Advertencia", "No existe el código", "warning");
                                }
                            } else {
                                swal("Advertencia", "Ingresar MAC del Servidor", "warning");
                            }
                        } else {
                            swal("Advertencia", "Ingresar Clave Secreta", "warning");
                        }
                    } else {
                        swal("Advertencia", "Ingresar Registro", "warning");
                    }
                } else {
                    swal("Advertencia", "Ingresar nombre de la empresa receptora", "warning");
                }

                return false;
            }

            function LimpiarCampos() {
                $('#DEPLOY').val("");
                $('#RECRET').val("");
                $('#COD1').val("");
                $('#COD2').val("");
                $('#COD3').val("");
                $('#COD4').val("");
            }

        </script>

    </body>

    </html>
